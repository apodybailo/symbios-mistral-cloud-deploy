#!/bin/bash

# üöÄ –ó–∞–ø—É—Å–∫–∞—î–º–æ Ollama —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ
ollama serve &

# ‚è≥ –ß–µ–∫–∞—î–º–æ, –ø–æ–∫–∏ Ollama –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π (–º–∞–∫—Å 60 —Å–µ–∫)
for i in {1..30}; do
  if curl -s http://localhost:11434 > /dev/null; then
    echo "‚úÖ Ollama –¥–æ—Å—Ç—É–ø–Ω–∏–π"
    break
  fi
  echo "‚åõ –û—á—ñ–∫—É—î–º–æ –∑–∞–ø—É—Å–∫ Ollama... ($i)"
  sleep 2
done

# üì¶ –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ llama2
if ! ollama list | grep -q "llama2"; then
  echo "üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –º–æ–¥–µ–ª—å LLaMA2..."
  ollama pull llama2
else
  echo "‚úÖ –ú–æ–¥–µ–ª—å LLaMA2 –≤–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞."
fi

# üß† –ó–∞–ø—É—Å–∫–∞—î–º–æ –º–æ–¥–µ–ª—å llama2 —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ
echo "üöÄ –ó–∞–ø—É—Å–∫–∞—î–º–æ –º–æ–¥–µ–ª—å llama2..."
nohup ollama run llama2 > /dev/null 2>&1 &

# üß∑ –£—Ç—Ä–∏–º—É—î–º–æ –ø—Ä–æ—Ü–µ—Å –∞–∫—Ç–∏–≤–Ω–∏–º
wait
